### Part 1. Настройка **gitlab-runner**

**== Задание ==**

##### Подними виртуальную машину *Ubuntu Server 22.04 LTS*.
##### Скачай и установи на виртуальную машину **gitlab-runner**.
`sudo curl -LJO "https://s3.dualstack.us-east-1.amazonaws.com/gitlab-runner-downloads/latest/deb/gitlab-runner_amd64.deb"`

`sudo dpkg -i gitlab-runner_amd64.deb`

![](img/1_01.jpg)
![](img/1_02.jpg)
##### Запусти **gitlab-runner** и зарегистрируй его для использования в текущем проекте (*DO6_CICD*).
- Для регистрации понадобятся URL и токен, которые можно получить на страничке задания на платформе.
`sudo gitlab-runner register`

![](img/1_03.jpg)
### Part 2. Сборка

**== Задание ==**

#### Напиши этап для **CI** по сборке приложений из проекта *C2_SimpleBashUtils*.
##### В файле _gitlab-ci.yml_ добавь этап запуска сборки через мейк файл из проекта _C2_.
##### Файлы, полученные после сборки (артефакты), сохрани в произвольную директорию со сроком хранения 30 дней.
`sudo gitlab-runner run`

![](img/2_01.jpg)
![](img/2_02.jpg)

### Part 3. Тест кодстайла

**== Задание ==**

#### Напиши этап для **CI**, который запускает скрипт кодстайла (*clang-format*).

![](img/3_01.jpg)
![](img/3_02.jpg)
##### Если кодстайл не прошел, то «зафейли» пайплайн.
##### В пайплайне отобрази вывод утилиты *clang-format*.

![](img/3_03.jpg)
### Part 4. Интеграционные тесты

**== Задание ==**

#### Напиши этап для **CI**, который запускает твои интеграционные тесты из того же проекта.
![](img/4_01.jpg)
##### Запусти этот этап автоматически только при условии, если сборка и тест кодстайла прошли успешно.
##### Если тесты не прошли, то «зафейли» пайплайн.

![](img/4_02.jpg)
##### В пайплайне отобрази вывод, что интеграционные тесты успешно прошли / провалились.

![](img/4_03.jpg)
### Part 5. Этап деплоя

`-` Для завершения этого задания ты должен перенести исполняемые файлы на другую виртуальную машину, которая будет играть роль продакшна. Удачи.

**== Задание ==**

##### Подними вторую виртуальную машину *Ubuntu Server 22.04 LTS*.
- Пропишем дополнительные адреса на машинах
![](img/5_01.jpg)
![](img/5_02.jpg)
- Сгенерируем на первой машине ssh ключ и скопируем на вторую машину
  ![](img/5_03.jpg)
#### Напиши этап для **CD**, который «разворачивает» проект на другой виртуальной машине.

![](img/5_04.jpg)
##### Запусти этот этап вручную при условии, что все предыдущие этапы прошли успешно.
##### Напиши bash-скрипт, который при помощи **ssh** и **scp** копирует файлы, полученные после сборки (артефакты), в директорию */usr/local/bin* второй виртуальной машины.

![](img/5_05.jpg)
![](img/5_06.jpg)

- Будь готов объяснить по скрипту, как происходит перенос.

##### В случае ошибки «зафейли» пайплайн.

![](img/5_07.jpg)

В результате ты должен получить готовые к работе приложения из проекта *C2_SimpleBashUtils* (s21_cat и s21_grep) на второй виртуальной машине.
![](img/5_08.jpg)

### Part 6. Дополнительно. Уведомления

**== Задание ==**

##### Настрой уведомления о успешном/неуспешном выполнении пайплайна через бота с именем «[твой nickname] DO6 CI/CD» в *Telegram*.
- Создадим нового бота в канале @BotFather
  ![](img/6_01.jpg)
- Узнаем ID пользователя в канале @userinfobot
  ![](img/6_02.jpg)
- Пропишем полученные токен и ID в скрипте телеграм бота
  ![](img/6_03.jpg)
- Добавим запуск скрипта tg_bot.sh после выполнения каждого из этапов в .gitlab-ci.yml
  ![](img/6_04.jpg)
- Текст уведомления должен содержать информацию об успешности прохождения как этапа **CI**, так и этапа **CD**.
  ![](img/6_05.jpg)